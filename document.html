<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document Analysis - AI For Everyone</title>
  <link rel="stylesheet" href="styles.css">
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script>
    // Configure PDF.js worker
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
  </script>
</head>
<body class="dashboard-body">
  <!-- Mobile Menu Button -->
  <button class="mobile-menu-btn" onclick="toggleSidebar()">☰</button>

  <!-- Sidebar Overlay -->
  <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <div class="logo-circle">AI</div>
      <span class="brand-name">AI For Everyone</span>
    </div>
    
    <nav class="sidebar-nav">
      <a href="dashboard.html" class="nav-item">
        <span class="nav-icon">🏠</span>
        Dashboard
      </a>
      <a href="chat.html" class="nav-item">
        <span class="nav-icon">💬</span>
        AI Chat
      </a>
      <a href="document.html" class="nav-item active">
        <span class="nav-icon">📄</span>
        Documents
      </a>
      <a href="image.html" class="nav-item">
        <span class="nav-icon">🎨</span>
        Images
      </a>
      <a href="history.html" class="nav-item">
        <span class="nav-icon">🕒</span>
        History
      </a>
      <a href="settings.html" class="nav-item">
        <span class="nav-icon">⚙️</span>
        Settings
      </a>
    </nav>

    <div class="sidebar-footer">
      <div class="user-profile">
        <img src="https://ui-avatars.com/api/?name=User&background=FF6B35&color=fff" alt="User" id="userAvatar">
        <div>
          <div class="user-name" id="userName">User</div>
          <div class="user-email" id="userEmail">user@email.com</div>
        </div>
      </div>
      <button class="btn-logout" onclick="logout()">Logout</button>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <header class="dashboard-header">
      <div>
        <h1>📄 Document Analysis</h1>
        <p>Upload documents and get AI-powered insights</p>
      </div>
    </header>

    <!-- Upload Section -->
    <div class="upload-section">
      <div class="upload-card">
        <div class="upload-icon">📄</div>
        <h2>Upload Your Document</h2>
        <p>Supported formats: PDF, TXT (text-based PDFs only)</p>
        
        <input type="file" id="documentUpload" accept=".pdf,.txt" onchange="uploadDocument()" style="display:none;">
        <button class="btn-primary large" onclick="document.getElementById('documentUpload').click()">
          📂 Choose & Upload File
        </button>
        
        <div class="or-divider">
          <span>OR</span>
        </div>
        
        <div class="paste-section">
          <h3>Paste Text Directly</h3>
          <textarea id="pastedText" placeholder="Paste your document text here..." rows="6"></textarea>
          <button class="btn-primary" onclick="uploadPastedText()">📝 Analyze Pasted Text</button>
        </div>
      </div>
    </div>

    <!-- Document Info Display (THIS WAS MISSING!) -->
    <div id="documentInfo" class="document-info-section" style="display:none;">
      <div class="info-card">
        <h3>📄 Uploaded Document</h3>
        <div class="doc-details-grid">
          <div class="doc-detail-item">
            <span class="detail-label">📋 Name:</span>
            <span class="detail-value" id="docName">-</span>
          </div>
          <div class="doc-detail-item">
            <span class="detail-label">💾 Size:</span>
            <span class="detail-value" id="docSize">-</span>
          </div>
          <div class="doc-detail-item">
            <span class="detail-label">📑 Type:</span>
            <span class="detail-value" id="docType">-</span>
          </div>
          <div class="doc-detail-item">
            <span class="detail-label">📄 Pages:</span>
            <span class="detail-value" id="docPages">-</span>
          </div>
          <div class="doc-detail-item">
            <span class="detail-label">🕒 Uploaded:</span>
            <span class="detail-value" id="docDate">-</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Analysis Section -->
    <div class="analysis-section">
      <div class="section-header">
        <h2>📊 Analysis Options</h2>
        <div class="button-group">
          <button class="btn-primary" onclick="analyzeDocument()" disabled>
            ✨ AI Summary
          </button>
          <button class="btn-secondary" onclick="extractKeyPoints()" disabled>
            🔑 Key Points
          </button>
        </div>
      </div>

      <!-- Summary Results -->
      <div id="analysisResults" class="result-card" style="display:none;">
        <div class="card-header">
          <h3><span class="icon">📝</span> AI Summary</h3>
        </div>
        <div id="summaryText" class="result-content"></div>
      </div>

      <!-- Key Points Results -->
      <div id="keyPointsCard" class="result-card" style="display:none;">
        <div class="card-header">
          <h3><span class="icon">🔑</span> Key Points</h3>
        </div>
        <ul id="keyPointsList" class="key-points-list"></ul>
      </div>
    </div>

    <!-- Q&A Section -->
    <div class="qa-section">
      <h3>❓ Ask Questions About This Document</h3>
      <div class="qa-input-group">
        <input 
          type="text" 
          id="questionInput" 
          placeholder="Ask a question about the document..." 
          disabled
        >
        <button class="btn-primary" onclick="askQuestion()" disabled>
          Ask
        </button>
      </div>
      <div id="qaResults" class="qa-results"></div>
    </div>
  </main>

  <script src="auth.js"></script>
  <script src="app.js"></script>
  <script src="document-analysis.js"></script>
</body>
</html>
